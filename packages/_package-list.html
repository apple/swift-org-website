{%- assign category = site.data.packages.packages.categories | where: "slug", include.category_slug | first %}
{%- assign secondary_sites = site.data.packages.packages.secondary_sites %}

<section class="package-list">
  <nav>
    <a href="{% link packages/index.md %}#package-ecosystem" rel="parent">Explore the Swift package ecosystem</a>
  </nav>

  {{ category.description | markdownify }}
  <ul>
    {% for package in category.packages %}
    <li>
      <a href="{{ package.url }}" target="_blank">
        <h4>
          <div class="name">{{ package.name }}</div>
          <div class="owner">by {{ package.owner }}</div>
        </h4>
        <section class="description">{{ package.description | markdownify }}</section>
        <section class="metadata">
          {% if package.platform_compatibility %}
          <div class="lozenge platform-compatibility" title="{{ package.platform_compatibility_tooltip }}">
            {% for platform in package.platform_compatibility %}
            <span>{{ platform }}</span>
            {% endfor %}
          </div>
          {% endif %} {% if package.swift_compatibility %}
          <div class="lozenge swift-compatibility" title="Swift version compatibility">
            <span>{{ package.swift_compatibility }}</span>
          </div>
          {% endif %}
          <div class="lozenge license" title="Package license"><span>{{ package.license }}</span></div>
        </section>
      </a>
      <section class="secondary-sites">
        {% for site in package.secondary_sites %}
          {%- assign site_details = secondary_sites[site.key] %}
          <a href="{{ site.url }}" target="_blank" title="View {{ package.name }} on {{ site_details.title }}">
            <img src="/assets/images/packages/secondary-sites/{{ site_details.logo }}" />
          </a>
        {% endfor %}
      </section>
      {% if package.note %}
      <section class="note">{{ package.note | markdownify }}</section>
      {% endif %}
    </li>
    {%- endfor %}
  </ul>

  {% if category.more %}
  <a class="cta-secondary" href="{{ category.more.url }}" target="_blank">{{ category.more.title }} &rsaquo;</a>
  {% endif %}
</section>
